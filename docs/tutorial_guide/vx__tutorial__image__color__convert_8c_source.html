<!-- This comment will put IE 6, 7 and 8 in quirks mode -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>TIOVX Tutorials: vx_tutorial_image_color_convert.c Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<img src="ti_logo.gif">
<tr bgcolor="#CCCCCC"> 
      <td bgcolor="#FFFFFF">
        <hr align="left" noshade size="1">
      </td>
</tr>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
    </ul>
  </div>
<h1>vx_tutorial_image_color_convert.c</h1><a href="vx__tutorial__image__color__convert_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*</span>
<a name="l00002"></a>00002 <span class="comment"> *******************************************************************************</span>
<a name="l00003"></a>00003 <span class="comment"> *</span>
<a name="l00004"></a>00004 <span class="comment"> * Copyright (C) 2017 Texas Instruments Incorporated - http://www.ti.com/</span>
<a name="l00005"></a>00005 <span class="comment"> * ALL RIGHTS RESERVED</span>
<a name="l00006"></a>00006 <span class="comment"> *</span>
<a name="l00007"></a>00007 <span class="comment"> *******************************************************************************</span>
<a name="l00008"></a>00008 <span class="comment"> */</span>
<a name="l00009"></a>00009 
<a name="l00057"></a>00057 <span class="preprocessor">#include &lt;stdio.h&gt;</span>
<a name="l00058"></a>00058 <span class="preprocessor">#include &lt;VX/vx.h&gt;</span>
<a name="l00059"></a>00059 <span class="preprocessor">#include &lt;<a class="code" href="utility_8h.html">utility.h</a>&gt;</span>
<a name="l00060"></a>00060 
<a name="l00062"></a><a class="code" href="vx__tutorial__image__color__convert_8c.html#a8118656bb5a60090a1dbffa402168438">00062</a> <span class="preprocessor">#define IN_FILE_NAME       &quot;colors.bmp&quot;</span>
<a name="l00063"></a>00063 <span class="preprocessor"></span>
<a name="l00065"></a><a class="code" href="vx__tutorial__image__color__convert_8c.html#a75506823f0db0ef3f4f022cf132dbbbb">00065</a> <span class="preprocessor">#define OUT_FILE_NAME      &quot;vx_tutorial_image_color_convert_out.bmp&quot;</span>
<a name="l00066"></a>00066 <span class="preprocessor"></span>
<a name="l00070"></a><a class="code" href="vx__tutorial__image__color__convert_8c.html#ad2b8fd09b4afa65ad14e89f0a9513f11">00070</a> <span class="keywordtype">void</span> <a class="code" href="vx__tutorial__image__color__convert_8c.html#ad2b8fd09b4afa65ad14e89f0a9513f11" title="Tutorial Entry Point.">vx_tutorial_image_color_convert</a>()
<a name="l00071"></a>00071 {
<a name="l00079"></a>00079     vx_context context;
<a name="l00080"></a>00080     vx_image rgb_image = NULL;
<a name="l00081"></a>00081     vx_image nv12_image = NULL;
<a name="l00082"></a>00082     vx_image y_image = NULL;
<a name="l00083"></a>00083     vx_node node0 = NULL, node1 = NULL;
<a name="l00084"></a>00084     vx_graph graph = NULL;
<a name="l00086"></a>00086     vx_uint32 width, height;
<a name="l00087"></a>00087     vx_status status;
<a name="l00088"></a>00088 
<a name="l00089"></a>00089     printf(<span class="stringliteral">&quot; vx_tutorial_image_color_convert: Tutorial Started !!! \n&quot;</span>);
<a name="l00090"></a>00090 
<a name="l00098"></a>00098     context = vxCreateContext();
<a name="l00101"></a>00101     printf(<span class="stringliteral">&quot; Loading file %s ...\n&quot;</span>, <a class="code" href="vx__tutorial__image__load__save_8c.html#a8118656bb5a60090a1dbffa402168438" title="Input file name.">IN_FILE_NAME</a>);
<a name="l00102"></a>00102 
<a name="l00108"></a>00108     graph = vxCreateGraph(context);
<a name="l00110"></a>00110     vxSetReferenceName((vx_reference)graph, <span class="stringliteral">&quot;MY_GRAPH&quot;</span>);
<a name="l00111"></a>00111 
<a name="l00119"></a>00119     rgb_image = <a class="code" href="utility_8h.html#af8e9cbbd49ab0dec7850267224548cd6" title="Create a image data object given BMP filename as input.">create_image_from_file</a>(context, <a class="code" href="vx__tutorial__image__load__save_8c.html#a8118656bb5a60090a1dbffa402168438" title="Input file name.">IN_FILE_NAME</a>, vx_false_e);
<a name="l00122"></a>00122     vxSetReferenceName((vx_reference)rgb_image, <span class="stringliteral">&quot;RGB_IMAGE&quot;</span>);
<a name="l00123"></a>00123 
<a name="l00131"></a>00131     <a class="code" href="utility_8h.html#ade45042efce712b30cf8254a6c90b3bc" title="Show attributes of previously created image.">show_image_attributes</a>(rgb_image);
<a name="l00134"></a>00134     vxQueryImage(rgb_image, VX_IMAGE_WIDTH, &amp;width, <span class="keyword">sizeof</span>(vx_uint32));
<a name="l00135"></a>00135     vxQueryImage(rgb_image, VX_IMAGE_HEIGHT, &amp;height, <span class="keyword">sizeof</span>(vx_uint32));
<a name="l00136"></a>00136 
<a name="l00146"></a>00146     nv12_image = vxCreateVirtualImage(graph, 0, 0, VX_DF_IMAGE_NV12);
<a name="l00148"></a>00148     vxSetReferenceName((vx_reference)nv12_image, <span class="stringliteral">&quot;NV12_IMAGE&quot;</span>);
<a name="l00156"></a>00156     <a class="code" href="utility_8h.html#ade45042efce712b30cf8254a6c90b3bc" title="Show attributes of previously created image.">show_image_attributes</a>(nv12_image);
<a name="l00166"></a>00166     y_image = vxCreateImage(context, width, height, VX_DF_IMAGE_U8);
<a name="l00168"></a>00168     vxSetReferenceName((vx_reference)y_image, <span class="stringliteral">&quot;Y_IMAGE&quot;</span>);
<a name="l00169"></a>00169     <a class="code" href="utility_8h.html#ade45042efce712b30cf8254a6c90b3bc" title="Show attributes of previously created image.">show_image_attributes</a>(y_image);
<a name="l00170"></a>00170 
<a name="l00179"></a>00179     node0 = vxColorConvertNode(graph, rgb_image, nv12_image);
<a name="l00181"></a>00181     vxSetReferenceName((vx_reference)node0, <span class="stringliteral">&quot;COLOR_CONVERT&quot;</span>);
<a name="l00182"></a>00182 
<a name="l00192"></a>00192     node1 = vxChannelExtractNode(graph, nv12_image, VX_CHANNEL_Y, y_image);
<a name="l00194"></a>00194     vxSetReferenceName((vx_reference)node1, <span class="stringliteral">&quot;CHANNEL_EXTRACT&quot;</span>);
<a name="l00195"></a>00195 
<a name="l00203"></a>00203     status = vxVerifyGraph(graph);
<a name="l00213"></a>00213     <a class="code" href="utility_8h.html#a86ae0d04d187710cc2d10f85bccb6e5d" title="Show attributes of previously created graph.">show_graph_attributes</a>(graph);
<a name="l00223"></a>00223     <a class="code" href="utility_8h.html#a4576aae15198e9645228f21be4290cff" title="Show attributes of previously created node.">show_node_attributes</a>(node0);
<a name="l00224"></a>00224     <a class="code" href="utility_8h.html#a4576aae15198e9645228f21be4290cff" title="Show attributes of previously created node.">show_node_attributes</a>(node1);
<a name="l00227"></a>00227     <span class="keywordflow">if</span>(status==VX_SUCCESS)
<a name="l00228"></a>00228     {
<a name="l00229"></a>00229         printf(<span class="stringliteral">&quot; Executing graph ...\n&quot;</span>);
<a name="l00230"></a>00230 
<a name="l00239"></a>00239         vxScheduleGraph(graph);
<a name="l00248"></a>00248         vxWaitGraph(graph);
<a name="l00251"></a>00251         printf(<span class="stringliteral">&quot; Executing graph ... Done !!!\n&quot;</span>);
<a name="l00252"></a>00252 
<a name="l00260"></a>00260         <a class="code" href="utility_8h.html#a86ae0d04d187710cc2d10f85bccb6e5d" title="Show attributes of previously created graph.">show_graph_attributes</a>(graph);
<a name="l00270"></a>00270         <a class="code" href="utility_8h.html#a4576aae15198e9645228f21be4290cff" title="Show attributes of previously created node.">show_node_attributes</a>(node0);
<a name="l00271"></a>00271         <a class="code" href="utility_8h.html#a4576aae15198e9645228f21be4290cff" title="Show attributes of previously created node.">show_node_attributes</a>(node1);
<a name="l00274"></a>00274         printf(<span class="stringliteral">&quot; Saving to file %s ...\n&quot;</span>, <a class="code" href="vx__tutorial__image__load__save_8c.html#a75506823f0db0ef3f4f022cf132dbbbb" title="Output file name.">OUT_FILE_NAME</a>);
<a name="l00275"></a>00275 
<a name="l00284"></a>00284         <a class="code" href="utility_8h.html#a2ffb77a8e510c0236b07306d0eb47a30" title="Save data from image object to BMP file.">save_image_to_file</a>(<a class="code" href="vx__tutorial__image__load__save_8c.html#a75506823f0db0ef3f4f022cf132dbbbb" title="Output file name.">OUT_FILE_NAME</a>, y_image);
<a name="l00286"></a>00286     }
<a name="l00287"></a>00287 
<a name="l00294"></a>00294     vxReleaseImage(&amp;rgb_image);
<a name="l00295"></a>00295     vxReleaseImage(&amp;nv12_image);
<a name="l00296"></a>00296     vxReleaseImage(&amp;y_image);
<a name="l00305"></a>00305     vxReleaseNode(&amp;node0);
<a name="l00306"></a>00306     vxReleaseNode(&amp;node1);
<a name="l00315"></a>00315     vxReleaseGraph(&amp;graph);
<a name="l00326"></a>00326     vxReleaseContext(&amp;context);
<a name="l00329"></a>00329     printf(<span class="stringliteral">&quot; vx_tutorial_image_color_convert: Tutorial Done !!! \n&quot;</span>);
<a name="l00330"></a>00330     printf(<span class="stringliteral">&quot; \n&quot;</span>);
<a name="l00331"></a>00331 }
<a name="l00332"></a>00332 
<a name="l00333"></a>00333 <span class="preprocessor">#define MAX_ATTRIBUTE_NAME (32u)</span>
<a name="l00334"></a>00334 <span class="preprocessor"></span>
<a name="l00344"></a><a class="code" href="vx__tutorial__image__color__convert_8c.html#a86ae0d04d187710cc2d10f85bccb6e5d">00344</a> <span class="keywordtype">void</span> <a class="code" href="utility_8h.html#a86ae0d04d187710cc2d10f85bccb6e5d" title="Show attributes of previously created graph.">show_graph_attributes</a>(vx_graph graph)
<a name="l00345"></a>00345 {
<a name="l00346"></a>00346     vx_uint32 num_nodes=0, num_params=0, ref_count=0;
<a name="l00347"></a>00347     vx_enum state=0;
<a name="l00348"></a>00348     vx_perf_t perf={0};
<a name="l00349"></a>00349     vx_char *ref_name=NULL;
<a name="l00350"></a>00350     <span class="keywordtype">char</span> ref_name_invalid[MAX_ATTRIBUTE_NAME];
<a name="l00351"></a>00351     <span class="keywordtype">char</span> state_name[MAX_ATTRIBUTE_NAME];
<a name="l00352"></a>00352 
<a name="l00359"></a>00359     vxQueryGraph(graph, VX_GRAPH_NUMNODES, &amp;num_nodes, <span class="keyword">sizeof</span>(vx_uint32));
<a name="l00360"></a>00360     vxQueryGraph(graph, VX_GRAPH_NUMPARAMETERS, &amp;num_params, <span class="keyword">sizeof</span>(vx_uint32));
<a name="l00361"></a>00361     vxQueryGraph(graph, VX_GRAPH_STATE, &amp;state, <span class="keyword">sizeof</span>(vx_enum));
<a name="l00362"></a>00362     vxQueryGraph(graph, VX_GRAPH_PERFORMANCE, &amp;perf, <span class="keyword">sizeof</span>(vx_perf_t));
<a name="l00365"></a>00365     vxQueryReference((vx_reference)graph, VX_REFERENCE_NAME, &amp;ref_name, <span class="keyword">sizeof</span>(vx_char*));
<a name="l00366"></a>00366     vxQueryReference((vx_reference)graph, VX_REFERENCE_COUNT, &amp;ref_count, <span class="keyword">sizeof</span>(vx_uint32));
<a name="l00367"></a>00367 
<a name="l00368"></a>00368     <span class="keywordflow">switch</span>(state)
<a name="l00369"></a>00369     {
<a name="l00370"></a>00370         <span class="keywordflow">case</span> VX_GRAPH_STATE_UNVERIFIED:
<a name="l00371"></a>00371             strncpy(state_name, <span class="stringliteral">&quot;VX_GRAPH_STATE_UNVERIFIED&quot;</span>, MAX_ATTRIBUTE_NAME);
<a name="l00372"></a>00372             <span class="keywordflow">break</span>;
<a name="l00373"></a>00373         <span class="keywordflow">case</span> VX_GRAPH_STATE_VERIFIED:
<a name="l00374"></a>00374             strncpy(state_name, <span class="stringliteral">&quot;VX_GRAPH_STATE_VERIFIED&quot;</span>, MAX_ATTRIBUTE_NAME);
<a name="l00375"></a>00375             <span class="keywordflow">break</span>;
<a name="l00376"></a>00376         <span class="keywordflow">case</span> VX_GRAPH_STATE_RUNNING:
<a name="l00377"></a>00377             strncpy(state_name, <span class="stringliteral">&quot;VX_GRAPH_STATE_RUNNING&quot;</span>, MAX_ATTRIBUTE_NAME);
<a name="l00378"></a>00378             <span class="keywordflow">break</span>;
<a name="l00379"></a>00379         <span class="keywordflow">case</span> VX_GRAPH_STATE_ABANDONED:
<a name="l00380"></a>00380             strncpy(state_name, <span class="stringliteral">&quot;VX_GRAPH_STATE_ABANDONED&quot;</span>, MAX_ATTRIBUTE_NAME);
<a name="l00381"></a>00381             <span class="keywordflow">break</span>;
<a name="l00382"></a>00382         <span class="keywordflow">case</span> VX_GRAPH_STATE_COMPLETED:
<a name="l00383"></a>00383             strncpy(state_name, <span class="stringliteral">&quot;VX_GRAPH_STATE_COMPLETED&quot;</span>, MAX_ATTRIBUTE_NAME);
<a name="l00384"></a>00384             <span class="keywordflow">break</span>;
<a name="l00385"></a>00385         <span class="keywordflow">default</span>:
<a name="l00386"></a>00386             strncpy(state_name, <span class="stringliteral">&quot;VX_GRAPH_STATE_UNKNOWN&quot;</span>, MAX_ATTRIBUTE_NAME);
<a name="l00387"></a>00387             <span class="keywordflow">break</span>;
<a name="l00388"></a>00388     }
<a name="l00389"></a>00389 
<a name="l00390"></a>00390     <span class="keywordflow">if</span>(ref_name==NULL)
<a name="l00391"></a>00391     {
<a name="l00392"></a>00392         strncpy(ref_name_invalid, <span class="stringliteral">&quot;INVALID_REF_NAME&quot;</span>, MAX_ATTRIBUTE_NAME);
<a name="l00393"></a>00393         ref_name = &amp;ref_name_invalid[0];
<a name="l00394"></a>00394     }
<a name="l00395"></a>00395 
<a name="l00396"></a>00396     printf(<span class="stringliteral">&quot; VX_TYPE_GRAPH: %s, %d nodes, %s, avg perf %9.6fs, %d parameters, %d refs\n&quot;</span>,
<a name="l00397"></a>00397         ref_name,
<a name="l00398"></a>00398         num_nodes,
<a name="l00399"></a>00399         state_name,
<a name="l00400"></a>00400         perf.avg/1000000000.0,
<a name="l00401"></a>00401         num_params,
<a name="l00402"></a>00402         ref_count
<a name="l00403"></a>00403         );
<a name="l00404"></a>00404 }
<a name="l00405"></a>00405 
<a name="l00415"></a><a class="code" href="vx__tutorial__image__color__convert_8c.html#a4576aae15198e9645228f21be4290cff">00415</a> <span class="keywordtype">void</span> <a class="code" href="utility_8h.html#a4576aae15198e9645228f21be4290cff" title="Show attributes of previously created node.">show_node_attributes</a>(vx_node node)
<a name="l00416"></a>00416 {
<a name="l00417"></a>00417     vx_uint32 num_params=0, ref_count=0;
<a name="l00418"></a>00418     vx_status status=VX_FAILURE;
<a name="l00419"></a>00419     vx_perf_t perf={0};
<a name="l00420"></a>00420     vx_char *ref_name=NULL;
<a name="l00421"></a>00421     <span class="keywordtype">char</span> ref_name_invalid[MAX_ATTRIBUTE_NAME];
<a name="l00422"></a>00422     <span class="keywordtype">char</span> status_name[MAX_ATTRIBUTE_NAME];
<a name="l00423"></a>00423 
<a name="l00430"></a>00430     vxQueryNode(node, VX_NODE_STATUS, &amp;status, <span class="keyword">sizeof</span>(vx_status));
<a name="l00431"></a>00431     vxQueryNode(node, VX_NODE_PARAMETERS, &amp;num_params, <span class="keyword">sizeof</span>(vx_uint32));
<a name="l00432"></a>00432     vxQueryNode(node, VX_NODE_PERFORMANCE, &amp;perf, <span class="keyword">sizeof</span>(vx_perf_t));
<a name="l00435"></a>00435     vxQueryReference((vx_reference)node, VX_REFERENCE_NAME, &amp;ref_name, <span class="keyword">sizeof</span>(vx_char*));
<a name="l00436"></a>00436     vxQueryReference((vx_reference)node, VX_REFERENCE_COUNT, &amp;ref_count, <span class="keyword">sizeof</span>(vx_uint32));
<a name="l00437"></a>00437 
<a name="l00438"></a>00438     <span class="keywordflow">switch</span>(status)
<a name="l00439"></a>00439     {
<a name="l00440"></a>00440         <span class="keywordflow">case</span> VX_SUCCESS:
<a name="l00441"></a>00441             strncpy(status_name, <span class="stringliteral">&quot;VX_SUCCESS&quot;</span>, MAX_ATTRIBUTE_NAME);
<a name="l00442"></a>00442             <span class="keywordflow">break</span>;
<a name="l00443"></a>00443         <span class="keywordflow">case</span> VX_FAILURE:
<a name="l00444"></a>00444             strncpy(status_name, <span class="stringliteral">&quot;VX_FAILURE&quot;</span>, MAX_ATTRIBUTE_NAME);
<a name="l00445"></a>00445             <span class="keywordflow">break</span>;
<a name="l00446"></a>00446         <span class="keywordflow">default</span>:
<a name="l00447"></a>00447             strncpy(status_name, <span class="stringliteral">&quot;VX_FAILURE_OTHER&quot;</span>, MAX_ATTRIBUTE_NAME);
<a name="l00448"></a>00448             <span class="keywordflow">break</span>;
<a name="l00449"></a>00449     }
<a name="l00450"></a>00450 
<a name="l00451"></a>00451     <span class="keywordflow">if</span>(ref_name==NULL)
<a name="l00452"></a>00452     {
<a name="l00453"></a>00453         strncpy(ref_name_invalid, <span class="stringliteral">&quot;INVALID_REF_NAME&quot;</span>, MAX_ATTRIBUTE_NAME);
<a name="l00454"></a>00454         ref_name = &amp;ref_name_invalid[0];
<a name="l00455"></a>00455     }
<a name="l00456"></a>00456 
<a name="l00457"></a>00457     printf(<span class="stringliteral">&quot; VX_TYPE_NODE: %s, %d params, avg perf %9.6fs, %s, %d refs\n&quot;</span>,
<a name="l00458"></a>00458         ref_name,
<a name="l00459"></a>00459         num_params,
<a name="l00460"></a>00460         perf.avg/1000000000.0,
<a name="l00461"></a>00461         status_name,
<a name="l00462"></a>00462         ref_count
<a name="l00463"></a>00463         );
<a name="l00464"></a>00464 }
</pre></div></div>

<html>
<table bordercolor="#FFFFFF" bgcolor="#FFFFFF" width="100%">
<tr bgcolor="#CCCCCC">
      <td bgcolor="#FFFFFF">
        <hr align="left" noshade size="1">
      </td>
</tr>
<tr bgcolor="#CCCCCC">
      <td bgcolor="#FFFFFF"><font face="Verdana, Arial, Helvetica, sans-serif" size="1" color="#000000"><b><i>
        &copy Copyright 2017 Texas Instruments Incorporated. All rights reserved. </i></b></font></td>
</tr>
<tr bgcolor="#CCCCCC">
      <td bgcolor="#FFFFFF"><font face="Verdana, Arial, Helvetica, sans-serif" size="1" color="#000000">
        Document generated by <b><i> doxygen </i></b> 1.6.1
  </font></td>
</tr>
</table>
